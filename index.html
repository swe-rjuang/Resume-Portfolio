<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin" />
    <title>Professional GameDev Portfolio</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font family -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background similar to GitHub */
            color: #c9d1d9; /* Light text */
        }
        /* Custom styles for the horizontal scrolling panel */
        .scroll-container::-webkit-scrollbar {
            height: 8px;
        }
        .scroll-container::-webkit-scrollbar-thumb {
            background-color: #30363d;
            border-radius: 4px;
        }
        .scroll-container::-webkit-scrollbar-track {
            background-color: #161b22;
        }
        .scroll-container {
            /* Fallback for Firefox */
            scrollbar-color: #30363d #161b22;
            /* Default cursor for drag interaction */
            cursor: grab;
            user-select: none; /* Prevents text selection while dragging */
        }
        .scroll-container.cursor-grabbing {
            cursor: grabbing;
        }
        
        .project-thumbnail {
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
            cursor: pointer;
        }
        .project-thumbnail.active {
            border-color: #58a6ff;
            box-shadow: 0 0 15px rgba(88, 166, 255, 0.5);
            transform: scale(1.05);
        }

        /* Ensure scroll buttons are on top of other elements */
        .scroll-btn {
            top: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ensure scroll wrapper allows space for enlarged thumbnails */
        #scroll-wrapper {
            overflow-y: visible !important;
        }
        
        /* Custom scrollbar for the image gallery row */
        #image-gallery::-webkit-scrollbar {
            height: 6px;
        }
        #image-gallery::-webkit-scrollbar-thumb {
            background-color: #30363d;
            border-radius: 3px;
        }
        #image-gallery::-webkit-scrollbar-track {
            background-color: transparent;
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="container mx-auto p-4 sm:p-8">
        <!-- Header Section -->
        <header class="text-left mb-8 sm:mb-12">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-[#58a6ff] mb-2"><span class="text-white">Rick Juang</span> <span class="font-normal text-gray-600">|</span> Portfolio</h1>
            <!--p class="text-xl text-gray-400">Turning complex systems into simple solutions</p-->
            <p class="text-xl text-gray-400">Gameplay Systems, AI Behaviors, UI and Tools Development</p>
        </header>

        <!-- Project Thumbnails (Side-Scrolling Panel with Controls) -->
        <div class="mb-10 p-4 bg-[#161b22] rounded-xl shadow-2xl border border-gray-700 relative group">
            <h2 class="text-2xl font-semibold mb-4 text-gray-200">Featured Projects</h2>
            
            <!-- Scrollable content wrapper (DRAGGABLE AREA) -->
            <!-- py-4 ensures space for the enlarged active thumbnail highlight -->
            <div id="scroll-wrapper" class="overflow-x-auto scroll-container py-4">
                <!-- px-14 provides margin for the scroll buttons to sit outside the thumbnails without clipping -->
                <div id="thumbnail-list" class="flex flex-nowrap space-x-6 px-4">
                    <!-- Thumbnails will be injected here by JavaScript -->
                </div>
            </div>

            <!-- Scroll Buttons (ABSOLUTELY POSITIONED) -->
            <button id="scroll-left-btn" class="scroll-btn absolute left-0 top-[52px] h-36 sm:h-36 py-2 px-2 rounded-r-lg opacity-0 invisible group-hover:opacity-100 transition-opacity duration-300 z-10 bg-gradient-to-r from-[#161b22] via-[#161b22] to-transparent text-[#58a6ff] focus:outline-none" aria-label="Scroll left">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
            </button>
            
            <button id="scroll-right-btn" class="scroll-btn absolute right-0 top-[52px] h-36 sm:h-36 py-2 px-2 rounded-l-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 bg-gradient-to-l from-[#161b22] via-[#161b22] to-transparent text-[#58a6ff] focus:outline-none" aria-label="Scroll right">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
            </button>
        </div>

        <!-- Project Detail Area (Updates on Click) -->
        <main id="project-details" class="bg-[#161b22] p-6 sm:p-10 rounded-xl shadow-2xl border border-gray-700 min-h-[600px]">
            <h2 class="3xl sm:text-4xl font-bold text-gray-50 mb-4" id="detail-title">Select a Project Above</h2>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Media Column (Image and Video) -->
                <div class="min-w-0"> 
                    <!-- Main Image Area -->
                    <div class="mb-4">
                        <img id="detail-image" class="w-full h-auto rounded-lg shadow-xl border border-gray-600 object-cover aspect-video min-w-0"
                                 src="https://placehold.co/800x450/1f242d/c9d1d9?text=Select+a+Project" alt="Project Main Visual">
                    </div>

                    <!-- NEW: Image Gallery/Carousel -->
                    <div id="image-gallery" class="flex space-x-3 overflow-x-auto pt-1 px-1 pb-4">
                        <!-- Image thumbnails injected here -->
                    </div>
                    <!-- END NEW: Image Gallery/Carousel -->

                    <!-- Embedded Video Area -->
                    <div class="aspect-video bg-gray-900 rounded-lg overflow-hidden shadow-xl" id="video-container">
                        <!-- Video iframe will be injected here -->
                        <div class="flex items-center justify-center h-full text-gray-500">
                            <span id="video-placeholder">Video content will appear here.</span>
                        </div>
                    </div>
                </div>

                <!-- Details Column (Description) -->
                <div class="pt-4">
                    <h3 class="text-2xl font-semibold mb-3 text-[#58a6ff]">Project Overview</h3>
                    <p id="detail-description" class="text-gray-400 leading-relaxed">
                        Click on any thumbnail in the scrolling panel above to load the corresponding project details, images, and embedded videos into this section.
                        This single-file HTML structure gives you complete control over presentation and interactivity.
                    </p>

                    <!-- Key Contributions Section -->
                    <div class="mt-8">
                        <h3 class="text-2xl font-semibold mb-3 text-[#58a6ff]">Key Contributions</h3>
                        <ul id="contributions-list" class="list-disc pl-5 space-y-2 text-gray-400">
                            <!-- List items will be injected here by JavaScript -->
                        </ul>
                    </div>
                    <!-- END Key Contributions Section -->
                    
                    <!-- NEW: Tech Stack Tags Container -->
                    <div class="mt-8">
                        <h3 class="text-2xl font-semibold mb-3 text-[#58a6ff]">Tech Stack</h3>
                        <div id="tech-stack-container" class="flex flex-wrap gap-2">
                            <!-- Dynamic tags injected here -->
                        </div>
                    </div>
                    <!-- END NEW: Tech Stack Tags Container -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- 1. MOCK DATA DEFINITION ---
        
        // Define styles for consistent tag colors
        const TAG_STYLES = {
            // Programming Languages
            'C': 'bg-blue-700 text-white',
            'C#': 'bg-purple-600 text-white',
            'C++': 'bg-blue-600 text-white',
			'Java': 'bg-white text-teal-700',
            'JavaScript': 'bg-yellow-400 text-black',
            'Python': 'bg-blue-400 text-yellow-200',
            'XAML': 'bg-blue-400 text-white',
            'XML': 'bg-white text-blue-500',
			// Game Engines & Frameworks
            'Blueprint': 'bg-blue-600 text-white',
            'CUDA': 'bg-green-500 text-black',
            'Godot': 'bg-blue-400 text-white',
            'Noesis GUI': 'bg-blue-500 text-white',
            'Ogre 3D': 'bg-lime-600 text-white',
            'OpenGL': 'bg-white text-slate-500',
            'PlayCanvas': 'bg-orange-400 text-white',
            'Proprietary Engine': 'bg-gray-700 text-white',
            'Stride': 'bg-red-500 text-white',
            'Unity': 'bg-white text-gray-500',
            'Unreal Engine 4': 'bg-black text-white',
            'Unreal Engine 5': 'bg-black text-white',
            'WebGL': 'bg-white text-red-600',
			// Tools & Plugins
            'Git': 'bg-orange-600 text-white',
            'Perforce': 'bg-indigo-600 text-white',
            // CI/CD & Monitoring
            'Grafana': 'bg-orange-600 text-white',
            'TeamCity': 'bg-green-400 text-white',
            // Domains & Systems
            'AI': 'bg-red-600 text-white',
            'Build Pipeline': 'bg-teal-600 text-white',
            'Multiplayer': 'bg-green-600 text-white',
            'Networking': 'bg-yellow-500 text-gray-900',
            'UI': 'bg-purple-600 text-white',
            'UI/UX': 'bg-purple-600 text-white',
            // Platforms
            'Android': 'bg-green-500 text-white',
            'PlayStation': 'bg-blue-900 text-white',
            'PSP': 'bg-gray-900 text-gray-300',
            'Xbox': 'bg-green-800 text-white',
            'iOS': 'bg-white text-black',
        };

        const projects = [
            /*{
                id: 'P2025-SOS',
                title: 'Stuck on Set',
                thumbnail_url: 'thumb/thumb_sos.jpg',
                detail_image_urls: [
                    'https://placehold.co/800x450/4A5568/ffffff?text=Tech+System+Diagram',
                    'https://placehold.co/120x90/4A5568/ffffff?text=Scene+View',
                    'https://placehold.co/120x90/4A5568/ffffff?text=Debug+Overlay',
                    'https://placehold.co/120x90/4A5568/ffffff?text=Performance+Graph'
                ],
                description: "This is a current, in-progress project focusing on the development of a highly scalable, data-oriented component system within Unreal Engine 5. We are using an NDA-safe description that focuses purely on the **technical systems** developed, rather than unannounced game content. The primary goal is achieving stable 60 FPS performance on lower-spec hardware.",
                contributions: [
                    "Object pooling system to eliminate allocation spikes and achieving frame stability during object spawning",
                    "Integration of the full menu system, enabling the delivery of core features such as pause, settings, save/load.",
                ],
                tech_stack: ['C++', 'Unreal Engine 5', 'Blueprint', 'UI'],
                video_embed_url: 'https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=0&controls=1&mute=1' // Rickroll (Good placeholder!)
            },*/
            {
                id: 'P2023-AFE',
                title: 'Aliens: Fireteam Elite',
                thumbnail_url: 'thumb/thumb_afe_180.jpg',
                detail_image_urls: [
                    'proj/scr_afe.jpg',
                    'proj/scr_afe_hub.jpg',
                    'proj/scr_afe_loadout.jpg',
                    'proj/scr_afe_head.jpg',
                ],
                description: "Contributed across the build pipeline and test infrastructure for this cooperative third-person survival shooter. Focused on improving stability, reducing QA cycles, and increasing engineering visibility into build health and test coverage.",
                contributions: [
                    "Integrated AI bot-driven simulated playthroughs into test infrastructure, reducing manual QA time.",
                    "Integrating and backporting narrative plugins across engine versions, improving cross-functional workflows and reducing design iteration time",
                    "Built analytics for nightly builds and test runs, boosting build health visibility 4× and reducing Mean Time To Detection (MTTD) by 85%",
                ],
                tech_stack: ['C++', 'Unreal Engine 4', 'Plugin', 'Build Pipeline', 'Perforce', 'C#', 'Python', 'Grafana', 'TeamCity', 'Xbox', 'PlayStation'],
                video_embed_url: 'https://www.youtube.com/embed/GHGL2kBbPCQ?autoplay=0&controls=1&mute=0'
            },
            {
                id: 'P2018-ZG',
                title: 'Zwift',
                thumbnail_url: 'thumb/thumb_zg_orange_180.jpg',
                detail_image_urls: [
                    'proj/scr_zg_group.jpg',
                    'proj/scr_zg_homescreen.jpg',
                    'proj/scr_zg_bink.jpg',
                    'proj/scr_zg_boostmode_menu.png',
                    'proj/scr_zg_boostmode.jpg',
                ],
                description: "A massively multiplayer online cycling and running game built on a custom C++ engine. My role evolved from focusing on high-performance C++ systems and complex refactoring to leading the Features Engineering team in charge of major product delivery. The primary challenge involved architecting scalable features for a large, monolithic codebase while simultaneously driving down technical debt and ensuring on-time delivery of consumer-facing releases. My work required deep expertise in low-latency systems, cross-platform architecture, and effective team management to deliver robust, scalable solutions for a rapidly growing user base.",
                contributions: [
                    "Led the Features Engineering team (6-8 reports), driving on-time delivery of major feature releases.",
                    "Architected activity recommendation, improving event discovery and reducing player friction.",
                    "Modularized monolithic end-game flow into scalable components, cutting technical debt and enabling major product version update. (<a href='https://zwiftinsider.com/return-to-home/' target='_blank' class='text-blue-500 hover:text-blue-400 underline'>Return to Home</a> Feature).",
                    "Consolidated and refactored legacy multiplayer and UI (HUD) codebases, reducing maintenance effort and improving development efficiency.",
                    "Developed the core mechanics for a physics-based online game game mode, managing real-time physics simulation and ensuring competitive integrity across concurrent users. (<a href='https://zwiftinsider.com/race-lost-boost-mode/' target='_blank' class='text-blue-500 hover:text-blue-400 underline'>Boost Mode</a> Race)",
                    "Designed a scalable video playback system utilizing CDN and feature flags for asset management, decoupling content from build releases and cutting install size."
                ],
                tech_stack: ['C++', 'Proprietary Engine', 'Multiplayer', 'UI', 'Noesis GUI', 'XAML', 'Git', 'Perforce', 'Android', 'iOS'],
                video_embed_url: 'https://www.youtube.com/embed/OupP9d3-Ugk?autoplay=0&controls=1&mute=0'
            },
            {
                id: 'P2010-TRON',
                title: 'TRON: Evolution (PSP)',
                thumbnail_url: 'thumb/thumb_tron_180.jpg',
                detail_image_urls: [
                    'proj/scr_tron_lightcycle.jpg',
                    'proj/scr_tron_disc.jpg',
                    'proj/scr_tron_tank.jpg',
                    'proj/scr_tron_parkour.jpg',
                ],
                description: "Developed critical AI and core gameplay systems for this third-person action-adventure title set in the TRON universe. The project required integrating complex character behaviors within a highly stylized digital environment, ensuring AI opponents and companions delivered a challenging and immersive experience that was faithful to the film’s high-speed action and combat.",
                contributions: [
                    "<b>Light Cycle</b>: player vehicle control and AI opponent behaviors for high-speed racing and battle segments.",
                    "<b>Disc Arena</b>: Pathfinding, AI behaviors and decision making logic for fast-paced combat scenarios, including cover, seeking, and flanking maneuvers.",
                    "<b>Tank Battle</b>: Utility AI framework for allied and enemy tank units.",
                    "NPC AI integration and behavior scripting for the core parkour and traversal system."
                ],
                tech_stack: ['C++', 'Proprietary Engine', 'PSP'],
                video_embed_url: 'https://www.youtube.com/embed/TfaagdJudL0?autoplay=0&controls=1&mute=0'
            },
            {
                id: 'P2009-FP',
                title: 'Fat Princess: Fistful of Cake',
                thumbnail_url: 'thumb/thumb_fp_180.jpg',
                detail_image_urls: [
                    'proj/scr_fp_bridge.jpg',
                    'proj/scr_fp_chapters.jpg',
                    'proj/scr_fp_lava.jpg',
                    'proj/scr_fp_gg.jpg',
                ],
                description: "Contributed to the PSP development of this critically acclaimed class-based multiplayer Action RTS title. The game required robust multi-goal AI systems, environmental interaction, and sophisticated pathfinding for the unique Fat Princess mechanic, which significantly impacted team strategy and level dynamics.",
                contributions: [
                    "Pathfinding and Navigation: Implemented and optimized pathfinding algorithms for allied and enemy units, ensuring stable navigation across dynamic level geometry on low-performance handheld hardware.",
                    "Utility AI System: Developed a utility-based AI framework for allied and enemy units, enabling adaptive and priority-driven behavior based on real-time game state and player actions.",
                    "Data Asset Conversion Tools: Created custom tools for converting and optimizing PS3 data assets for deployment on the PSP platform, ensuring cross-platform parity.",
                    "Game Systems Integration: Developed code to support core gameplay mechanics, including resource gathering, unit spawning, and the unique Princess movement logic tied to consumed food level.",
                    "Multiplayer Consistency: Ensured reliable synchronization of key game state elements, specifically related to unit actions and AI objectives, crucial for a fast-paced, competitive multiplayer environment.",
                ],
                tech_stack: ['C++', 'Proprietary Engine', 'PSP', 'XML'],
                //video_embed_url: 'https://www.youtube.com/embed/wFoKfmCdFys?autoplay=0&controls=1&mute=0'  // trailer
                video_embed_url: 'https://www.youtube.com/embed/Ql0WWP03CXY?autoplay=0&controls=1&mute=0'
            },
            {
                id: 'P2007-FLOW',
                title: 'flOw (PSP)',
                thumbnail_url: 'thumb/thumb_flow_180.jpg',
                detail_image_urls: [
                    'proj/scr_flow_snake.jpg',
                    'proj/scr_flow_jelly.jpg',
                    'proj/scr_flow_manta.jpg',
                    'proj/scr_flow_rogue.jpg',
                    'proj/scr_flow_hunter.jpg',
                ],
                description: "A simple, abstract game that required custom physics implementation and dynamic UI scaling. This project focused heavily on efficient rendering pipelines for stylized 2D elements.",
                contributions: [
                    "Developed a hierarchical state machine for dynamic creature evolution and behavior transitions.",
                    "Implemented the core growth and consumption mechanics.",
                    "Engineered the menu-less save/load system, allowing seamless gameplay resumption.",
                ],
                tech_stack: ['C++', 'Proprietary Engine', 'PSP'],
                video_embed_url: 'https://www.youtube.com/embed/videoseries?list=PLU4OB251Yy6Nb5qzNlD6JoIHGj65DNQNm&controls=1&mute=1'
            },
            {
                id: 'P2025-GT',
                title: 'Academic & Experimental Works',
                thumbnail_url: 'thumb/thumb_gatech_180.jpg',
                detail_image_urls: [
                    'https://placehold.co/800x450/4299E1/ffffff?text=Prison+Dodge+Ball+AI+Agents',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Fuzzy+Logic+Controller',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Dynamic+Path+Planning',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Ballistic+Projectile+Simulation',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Inverse+Kinematics+Solver',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Rigidbody+Collision',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Constraint+System',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Physics+Integrator',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Spline',
                ],
                description: "A collection of class projects. (WIP)",
                contributions: [
                    "TBD",
                ],
                tech_stack: ['Unity', 'C#', 'Java', 'Python', 'CUDA'],
                video_embed_url: 'https://www.youtube.com/embed/OCGrrtmS75U?si=XYsZABeTxl8T5aPq?autoplay=0&controls=1&mute=0'
            },
            {
                id: 'P2025-X',
                title: 'Personal Projects',
                //thumbnail_url: 'thumb/thumb_spawner_180.jpg',
                thumbnail_url: 'https://placehold.co/800x450/303330/ffcc00?text=Personal+Projects',
                detail_image_urls: [
                    'proj/scr_spawner_512.jpg',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Project+Spawner',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Project+Rainmaker',
                    'https://placehold.co/800x450/4299E1/ffffff?text=WebGL+Test',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Helium+Engine',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Entity+Component+System',
                    'https://placehold.co/800x450/4299E1/ffffff?text=Sprite+and+2D+Particle+System',
                ],
                description: "A collection of personal projects. (WIP)",
                contributions: [
                    "TBD",
                ],
                tech_stack: Object.keys(TAG_STYLES), 
                video_embed_url: 'https://www.youtube.com/embed/Me91tPpnyus?autoplay=0&controls=1&mute=0'
            },
        ];

        // --- 2. DOM ELEMENT REFERENCES ---
        const thumbnailList = document.getElementById('thumbnail-list');
        const detailTitle = document.getElementById('detail-title');
        const detailImage = document.getElementById('detail-image');
        const detailDescription = document.getElementById('detail-description');
        const videoContainer = document.getElementById('video-container');
        const contributionsList = document.getElementById('contributions-list'); 
        
        const scrollWrapper = document.getElementById('scroll-wrapper');
        const scrollLeftBtn = document.getElementById('scroll-left-btn');
        const scrollRightBtn = document.getElementById('scroll-right-btn');
        
        const imageGallery = document.getElementById('image-gallery'); 
        const techStackContainer = document.getElementById('tech-stack-container'); // NEW REFERENCE

        let activeProject = null;
        
        // --- 3. CORE RENDERING FUNCTION ---

        /**
         * Updates the main detail panel with content from the selected project.
         * @param {object} project - The project data object.
         */
        function renderProjectDetails(project) {
            
            // --- Update Text and Main Image ---
            detailTitle.textContent = project.title;
            
            // Set main image to the first URL in the array
            detailImage.src = project.detail_image_urls[0];
            detailImage.alt = `${project.title} Screenshot`;
            detailDescription.textContent = project.description;

            // --- Update Contributions List ---
            contributionsList.innerHTML = ''; // Clear previous list
            project.contributions.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = item;
                contributionsList.appendChild(li);
            });
            
            // --- Update Image Gallery ---
            imageGallery.innerHTML = ''; // Clear previous gallery
            project.detail_image_urls.forEach((url, index) => {
                const imgWrapper = document.createElement('div');
                imgWrapper.className = `w-24 h-16 flex-shrink-0 rounded-md border-2 object-cover overflow-hidden transition duration-150 ease-in-out cursor-pointer hover:border-[#58a6ff] ${index === 0 ? 'border-[#58a6ff] scale-[1.05]' : 'border-transparent'}`;
                imgWrapper.id = `gallery-thumb-${project.id}-${index}`; // Unique ID

                const img = document.createElement('img');
                img.src = url;
                // Add onerror to handle bad placeholder URLs from the mock data
                img.onerror = function() { this.src = 'https://placehold.co/120x90/1f242d/c9d1d9?text=Image'; };
                img.alt = `${project.title} Screenshot ${index + 1}`;
                img.className = 'w-full h-full object-cover';
                
                imgWrapper.addEventListener('click', () => {
                    // Switch main image
                    detailImage.src = url;
                    
                    // Update active border style in gallery
                    document.querySelectorAll('#image-gallery > div').forEach(thumb => {
                        thumb.classList.remove('border-[#58a6ff]', 'scale-[1.05]');
                        thumb.classList.add('border-transparent');
                    });
                    imgWrapper.classList.add('border-[#58a6ff]', 'scale-[1.05]');
                    imgWrapper.classList.remove('border-transparent');
                });

                imgWrapper.appendChild(img);
                imageGallery.appendChild(imgWrapper);
            });

            // --- Update Video Embed ---
            const videoIframe = `
                <iframe
                    class="w-full h-full"
                    src="${project.video_embed_url}"
                    title="YouTube video player for ${project.title}"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin"
                    >
                </iframe>
            `;
            videoContainer.innerHTML = videoIframe;

            // --- Update Tech Stack Tags (NEW LOGIC) ---
            techStackContainer.innerHTML = ''; // Clear previous tags
            project.tech_stack.forEach(tag => {
                const styleClass = TAG_STYLES[tag] || 'bg-gray-700 text-white'; // Default style
                const span = document.createElement('span');
                // The structure for the tag
                span.className = `text-sm font-medium py-1 px-3 rounded-full shadow-md ${styleClass}`;
                span.textContent = tag;
                techStackContainer.appendChild(span);
            });


            // --- Update Active State (Styling for Thumbnail List) ---
            if (activeProject) {
                document.getElementById(`thumb-${activeProject}`).classList.remove('active');
            }
            document.getElementById(`thumb-${project.id}`).classList.add('active');
            activeProject = project.id;
        }
        
        // --- 4. INTERACTIVE SCROLLING LOGIC ---
        
        const SCROLL_DISTANCE = 300; // Pixels to scroll per click

        /** Checks if the scroll boundaries are hit and updates button visibility. */
        function checkScrollPosition() {
            window.requestAnimationFrame(() => {
                const { scrollLeft, scrollWidth, clientWidth } = scrollWrapper;
                const tolerance = 5; // Allow for slight floating point errors

                // Show/Hide Left Button
                if (scrollLeft <= tolerance) {
                    scrollLeftBtn.classList.add('invisible');
                } else {
                    scrollLeftBtn.classList.remove('invisible');
                }

                // Show/Hide Right Button
                if (scrollWidth - clientWidth - scrollLeft <= tolerance) {
                    scrollRightBtn.classList.add('invisible');
                } else {
                    scrollRightBtn.classList.remove('invisible');
                }
            });
        }
        
        /** Scrolls the wrapper smoothly based on direction (-1 for left, 1 for right). */
        function smoothScroll(direction) {
            scrollWrapper.scrollBy({
                left: direction * SCROLL_DISTANCE,
                behavior: 'smooth'
            });
        }
        
        // A. Drag Scrolling (Mouse Down/Move/Up)
        let isDown = false;
        let startX;
        let scrollLeftPos;

        scrollWrapper.addEventListener('mousedown', (e) => {
            isDown = true;
            scrollWrapper.classList.add('cursor-grabbing');
            startX = e.pageX - scrollWrapper.offsetLeft;
            scrollLeftPos = scrollWrapper.scrollLeft;
            scrollWrapper.style.cursor = 'grabbing';
            scrollWrapper.style.userSelect = 'none';    
        });

        scrollWrapper.addEventListener('mouseleave', () => {
            if (isDown) { // Only reset if drag was active
                isDown = false;
                scrollWrapper.classList.remove('cursor-grabbing');
                scrollWrapper.style.cursor = 'grab';
                scrollWrapper.style.userSelect = 'auto';
            }
        });

        scrollWrapper.addEventListener('mouseup', () => {
            isDown = false;
            scrollWrapper.classList.remove('cursor-grabbing');
            scrollWrapper.style.cursor = 'grab';
            scrollWrapper.style.userSelect = 'auto';
        });

        scrollWrapper.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault(); 
            const x = e.pageX - scrollWrapper.offsetLeft;
            const walk = (x - startX) * 1.5; 
            scrollWrapper.scrollLeft = scrollLeftPos - walk;
        });
        
        // B. Mouse Wheel Scrolling
        scrollWrapper.addEventListener('wheel', (e) => {
            e.preventDefault();    
            scrollWrapper.scrollLeft += e.deltaY;
        });
        
        // C. Button & Scroll Listeners
        scrollLeftBtn.addEventListener('click', () => smoothScroll(-1));
        scrollRightBtn.addEventListener('click', () => smoothScroll(1));
        
        scrollWrapper.addEventListener('scroll', checkScrollPosition);    

        // --- 5. INITIALIZATION ---

        /**
         * Generates the initial thumbnail list and sets up click listeners.
         */
        function initializeThumbnails() {
            projects.forEach(project => {
                const button = document.createElement('button');
                button.id = `thumb-${project.id}`;
                button.className = 'project-thumbnail w-[160px] h-[90px] flex-shrink-0 rounded-lg border-2 border-transparent hover:border-[#58a6ff]/50 hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-[#58a6ff]';
                
                const img = document.createElement('img');
                img.src = project.thumbnail_url;
                // Add an error fallback for placeholder images
                img.onerror = function() { this.src = 'https://placehold.co/150x90/1f242d/c9d1d9?text='+project.title; };
                img.alt = `${project.title} Thumbnail`;
                img.className = 'w-full h-full object-cover rounded-lg'; 
                
                button.appendChild(img);
                
                button.addEventListener('click', () => {
                    renderProjectDetails(project);
                });

                thumbnailList.appendChild(button);
            });

            // Load the first project by default on page load
            if (projects.length > 0) {
                renderProjectDetails(projects[0]);
            }
        }
        
        /** Combines thumbnail initialization with scroll initialization */
        function initializeApp() {
            initializeThumbnails();
            // Check initial scroll position to hide the left button
            checkScrollPosition();    
        }

        // Run initialization when the window loads
        window.onload = initializeApp;
    </script>
</body>
</html>
